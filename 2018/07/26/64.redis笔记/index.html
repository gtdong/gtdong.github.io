<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.4.2">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" integrity="sha256-DfWjNxDkM94fVBWx1H5BMMp0Zq7luBlV8QRcSES7s+0=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"gtdong.github.io","root":"/","images":"/images","scheme":"Gemini","darkmode":false,"version":"8.11.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"gitalk","active":true,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="一 简介">
<meta property="og:type" content="article">
<meta property="og:title" content="redis笔记">
<meta property="og:url" content="https://gtdong.github.io/2018/07/26/64.redis%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="TsukiBlog">
<meta property="og:description" content="一 简介">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/gtdong/images/raw/master/blog/1350514-20181022174851255-1938821619.png">
<meta property="og:image" content="https://gitee.com/gtdong/images/raw/master/blog/1350514-20181022175533950-849327963.png">
<meta property="og:image" content="https://gitee.com/gtdong/images/raw/master/blog/1350514-20181022195454464-123231904.png">
<meta property="og:image" content="https://img2018.cnblogs.com/blog/1350514/201810/1350514-20181022211822785-370585666.png">
<meta property="og:image" content="https://common.cnblogs.com/images/copycode.gif">
<meta property="og:image" content="https://common.cnblogs.com/images/copycode.gif">
<meta property="og:image" content="https://common.cnblogs.com/images/copycode.gif">
<meta property="og:image" content="https://common.cnblogs.com/images/copycode.gif">
<meta property="og:image" content="https://common.cnblogs.com/images/copycode.gif">
<meta property="article:published_time" content="2018-07-26T05:05:00.000Z">
<meta property="article:modified_time" content="2022-04-30T16:12:01.090Z">
<meta property="article:author" content="Michaeldong">
<meta property="article:tag" content="Python">
<meta property="article:tag" content="Redis">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/gtdong/images/raw/master/blog/1350514-20181022174851255-1938821619.png">


<link rel="canonical" href="https://gtdong.github.io/2018/07/26/64.redis%E7%AC%94%E8%AE%B0/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://gtdong.github.io/2018/07/26/64.redis%E7%AC%94%E8%AE%B0/","path":"2018/07/26/64.redis笔记/","title":"redis笔记"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>redis笔记 | TsukiBlog</title>
  




<link rel="stylesheet" href="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.css"><style>
#needsharebutton-postbottom {
  cursor: pointer;
  height: 26px;
  margin-top: 10px;
  position: relative;
}
#needsharebutton-postbottom .btn {
  border: 1px solid $btn-default-border-color;
  border-radius: 3px;
  display: initial;
  padding: 1px 4px;
}
</style>
  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">TsukiBlog</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80-%E7%AE%80%E4%BB%8B"><span class="nav-number">1.</span> <span class="nav-text">一 简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C-redis%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="nav-number">2.</span> <span class="nav-text">二 redis的安装和使用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89-Python%E6%93%8D%E4%BD%9CRedis%E4%B9%8B%E5%AE%89%E8%A3%85%E5%92%8C%E6%94%AF%E6%8C%81%E5%AD%98%E5%82%A8%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.</span> <span class="nav-text">三 Python操作Redis之安装和支持存储类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B-Python%E6%93%8D%E4%BD%9CRedis%E4%B9%8B%E6%99%AE%E9%80%9A%E8%BF%9E%E6%8E%A5"><span class="nav-number">4.</span> <span class="nav-text">四 Python操作Redis之普通连接</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B-Python%E6%93%8D%E4%BD%9CRedis%E4%B9%8B%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="nav-number">5.</span> <span class="nav-text">四 Python操作Redis之连接池</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94-%E6%93%8D%E4%BD%9C%E4%B9%8BString%E6%93%8D%E4%BD%9C"><span class="nav-number">6.</span> <span class="nav-text">五 操作之String操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AD-%E6%93%8D%E4%BD%9C%E4%B9%8BHash%E6%93%8D%E4%BD%9C"><span class="nav-number">7.</span> <span class="nav-text">六 操作之Hash操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%83-%E6%93%8D%E4%BD%9C%E4%B9%8BList%E6%93%8D%E4%BD%9C"><span class="nav-number">8.</span> <span class="nav-text">七 操作之List操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AB-%E6%93%8D%E4%BD%9C%E4%B9%8BSet%E6%93%8D%E4%BD%9C"><span class="nav-number">9.</span> <span class="nav-text">八 操作之Set操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B9%9D-%E5%85%B6%E5%AE%83%E6%93%8D%E4%BD%9C"><span class="nav-number">10.</span> <span class="nav-text">九 其它操作</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E4%B8%80-%E7%AE%A1%E9%81%93"><span class="nav-number">11.</span> <span class="nav-text">十一 管道</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E4%BA%8C-Django%E4%B8%AD%E4%BD%BF%E7%94%A8redis"><span class="nav-number">12.</span> <span class="nav-text">十二 Django中使用redis</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Michaeldong"
      src="/images/avatar.jpeg">
  <p class="site-author-name" itemprop="name">Michaeldong</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">81</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">8</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="sidebar-button site-overview-item animated">
    <button><i class="fa fa-comment"></i>
      Chat
    </button>
  </div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/gtdong" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;gtdong" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/gtdong" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://gtdong.github.io/2018/07/26/64.redis%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpeg">
      <meta itemprop="name" content="Michaeldong">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="TsukiBlog">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="redis笔记 | TsukiBlog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          redis笔记
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-07-26 13:05:00" itemprop="dateCreated datePublished" datetime="2018-07-26T13:05:00+08:00">2018-07-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2022-05-01 00:12:01" itemprop="dateModified" datetime="2022-05-01T00:12:01+08:00">2022-05-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Python%E4%B9%8B%E8%B7%AF/" itemprop="url" rel="index"><span itemprop="name">Python之路</span></a>
        </span>
    </span>

  
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>13k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>12 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="一-简介"><a href="#一-简介" class="headerlink" title="一 简介"></a>一 简介</h2><span id="more"></span>

<p>redis是一个key-value存储系统。和Memcached类似，它支持存储的value类型相对更多，包括string(字符串)、list(链表)、set(集合)、zset(sorted set –有序集合)和hash（哈希类型）。这些数据类型都支持push/pop、add/remove及取交集并集和差集及更丰富的操作，而且这些操作都是原子性的。在此基础上，redis支持各种不同方式的排序。与memcached一样，为了保证效率，数据都是缓存在内存中。区别的是redis会周期性的把更新的数据写入磁盘或者把修改操作写入追加的记录文件，并且在此基础上实现了master-slave(主从)同步</p>
<p>View Code</p>
<p><strong>支持的数据类型（5大数据类型）</strong></p>
<p><img src="https://gitee.com/gtdong/images/raw/master/blog/1350514-20181022174851255-1938821619.png" alt="img"></p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">redis</span>=&#123;</span><br><span class="line">        k1:<span class="string">&#x27;123&#x27;</span>,      字符串</span><br><span class="line">        k2:[1,2,3,4],   列表/数组</span><br><span class="line">        k3:&#123;1,2,3,4&#125;     集合</span><br><span class="line">        k4:&#123;name:lqz,age:12&#125;  字典/哈希表</span><br><span class="line">        k5:&#123;(<span class="string">&#x27;lqz&#x27;</span>,18),(<span class="string">&#x27;egon&#x27;</span>,33)&#125;  有序集合</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>特点：</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">可以持久化</span><br><span class="line">单线程，单进程</span><br></pre></td></tr></table></figure>

<h2 id="二-redis的安装和使用"><a href="#二-redis的安装和使用" class="headerlink" title="二 redis的安装和使用"></a>二 redis的安装和使用</h2><p><strong>linux下安装</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wget http://download.redis.io/releases/redis-3.0.6.tar.gz</span><br><span class="line">tar xzf redis-3.0.6.tar.gz</span><br><span class="line">cd redis-3.0.6</span><br><span class="line">make</span><br></pre></td></tr></table></figure>

<p><strong>启动服务端</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">src/redis-server</span><br></pre></td></tr></table></figure>

<p><strong>启动客户端</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">src/redis-cli</span><br><span class="line"><span class="meta prompt_">redis&gt; </span><span class="language-bash"><span class="built_in">set</span> foo bar</span></span><br><span class="line">OK</span><br><span class="line"><span class="meta prompt_">redis&gt; </span><span class="language-bash">get foo</span></span><br><span class="line">&quot;bar&quot;</span><br></pre></td></tr></table></figure>

<p><strong>Windows下安装</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/liuqingzheng/p/9831331.html">详见：链接</a></p>
<h2 id="三-Python操作Redis之安装和支持存储类型"><a href="#三-Python操作Redis之安装和支持存储类型" class="headerlink" title="三 Python操作Redis之安装和支持存储类型"></a>三 Python操作Redis之安装和支持存储类型</h2><p><strong>安装redis模块</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip3 install redis</span><br></pre></td></tr></table></figure>

<h2 id="四-Python操作Redis之普通连接"><a href="#四-Python操作Redis之普通连接" class="headerlink" title="四 Python操作Redis之普通连接"></a>四 Python操作Redis之普通连接</h2><p>redis-py提供两个类Redis和StrictRedis用于实现Redis的命令，StrictRedis用于实现大部分官方的命令，并使用官方的语法和命令，Redis是StrictRedis的子类，用于向后兼容旧版本的redis-py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"></span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;127.0.0.1&#x27;</span>, port=<span class="number">6379</span>)</span><br><span class="line">r.<span class="built_in">set</span>(<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;Bar&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.get(<span class="string">&#x27;foo&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="四-Python操作Redis之连接池"><a href="#四-Python操作Redis之连接池" class="headerlink" title="四 Python操作Redis之连接池"></a>四 Python操作Redis之连接池</h2><p>redis-py使用connection pool来管理对一个redis server的所有连接，避免每次建立、释放连接的开销。默认，每个Redis实例都会维护一个自己的连接池。可以直接建立一个连接池，然后作为参数Redis，这样就可以实现多个Redis实例共享一个连接池</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"></span><br><span class="line">pool = redis.ConnectionPool(host=<span class="string">&#x27;127.0.0.1&#x27;</span>, port=<span class="number">6379</span>)</span><br><span class="line">r = redis.Redis(connection_pool=pool)</span><br><span class="line">r.<span class="built_in">set</span>(<span class="string">&#x27;foo&#x27;</span>, <span class="string">&#x27;Bar&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(r.get(<span class="string">&#x27;foo&#x27;</span>))</span><br></pre></td></tr></table></figure>

<h2 id="五-操作之String操作"><a href="#五-操作之String操作" class="headerlink" title="五 操作之String操作"></a>五 操作之String操作</h2><p>String操作，redis中的String在在内存中按照一个name对应一个value来存储。如图：</p>
<p><img src="https://gitee.com/gtdong/images/raw/master/blog/1350514-20181022175533950-849327963.png" alt="img"></p>
<p><strong>set(name, value, ex=None, px=None, nx=False, xx=False)</strong></p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在Redis中设置值，默认，不存在则创建，存在则修改</span><br><span class="line">参数：</span><br><span class="line">     ex，过期时间（秒）</span><br><span class="line">     px，过期时间（毫秒）</span><br><span class="line">     nx，如果设置为<span class="keyword">True</span>，则只有<span class="type">name</span>不存在时，当前<span class="keyword">set</span>操作才执行,值存在，就修改不了，执行没效果</span><br><span class="line">     xx，如果设置为<span class="keyword">True</span>，则只有<span class="type">name</span>存在时，当前<span class="keyword">set</span>操作才执行，值存在才能修改，值不存在，不会设置新值</span><br></pre></td></tr></table></figure>

<p><strong>setnx(name, value)</strong></p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">设置值，只有<span class="keyword">name</span>不存在时，执行设置操作（添加）,如果存在，不会修改</span><br></pre></td></tr></table></figure>

<p><strong>setex(name, value, time)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 设置值</span></span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># time，过期时间（数字秒 或 timedelta对象）</span></span><br></pre></td></tr></table></figure>

<p><strong>psetex(name, time_ms, value)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 设置值</span></span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># time_ms，过期时间（数字毫秒 或 timedelta对象</span></span><br></pre></td></tr></table></figure>

<p>*<em>mset(*args, *<em>kwargs)</em></em></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">批量设置值</span><br><span class="line">如：</span><br><span class="line">    mset(<span class="attribute">k1</span>=<span class="string">&#x27;v1&#x27;</span>, <span class="attribute">k2</span>=<span class="string">&#x27;v2&#x27;</span>)</span><br><span class="line">    或</span><br><span class="line">    mget(&#123;<span class="string">&#x27;k1&#x27;</span>: <span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>: <span class="string">&#x27;v2&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>get(name)</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">获取值</span><br></pre></td></tr></table></figure>

<p><strong>mget(keys, *args)</strong></p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">批量获取</span><br><span class="line">如：</span><br><span class="line">    <span class="built_in">mget</span>(<span class="string">&#x27;k1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>)</span><br><span class="line">    或</span><br><span class="line">    r<span class="selector-class">.mget</span>(<span class="selector-attr">[<span class="string">&#x27;k3&#x27;</span>, <span class="string">&#x27;k4&#x27;</span>]</span>)</span><br></pre></td></tr></table></figure>

<p><strong>getset(name, value)</strong></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">设置新值并获取原来的值</span><br></pre></td></tr></table></figure>

<p><strong>getrange(key, start, end)</strong></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取子序列（根据字节获取，非字符）</span></span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># name，Redis 的 name</span></span><br><span class="line">    <span class="meta"># start，起始位置（字节）</span></span><br><span class="line">    <span class="meta"># end，结束位置（字节）</span></span><br><span class="line"><span class="meta"># 如： <span class="string">&quot;刘清政&quot;</span> ，0-3表示 <span class="string">&quot;刘&quot;</span></span></span><br></pre></td></tr></table></figure>

<p><strong>setrange(name, offset, value)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 修改字符串内容，从指定字符串索引开始向后替换（新值太长时，则向后添加）</span></span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># offset，字符串的索引，字节（一个汉字三个字节）</span></span><br><span class="line">    <span class="meta"># value，要设置的值</span></span><br></pre></td></tr></table></figure>

<p><strong>setbit(name, offset, value)</strong></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 对name对应值的二进制表示的位进行操作</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># name，redis的name</span></span><br><span class="line">    <span class="meta"># offset，位的索引（将值变换成二进制后再进行索引）</span></span><br><span class="line">    <span class="meta"># value，值只能是 1 或 0</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 注：如果在Redis中有一个对应： n1 = <span class="string">&quot;foo&quot;</span>，</span></span><br><span class="line">        那么字符串foo的二进制表示为：<span class="number">01100110</span> <span class="number">01101111</span> <span class="number">01101111</span></span><br><span class="line">    所以，如果执行 setbit(<span class="string">&#x27;n1&#x27;</span>, <span class="number">7</span>, <span class="number">1</span>)，则就会将第<span class="number">7</span>位设置为<span class="number">1</span>，</span><br><span class="line">        那么最终二进制则变成 <span class="number">01100111</span> <span class="number">01101111</span> <span class="number">01101111</span>，即：<span class="string">&quot;goo&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>getbit(name, offset)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取name对应的值的二进制表示中的某位的值 （0或1）</span></span><br></pre></td></tr></table></figure>

<p><strong>bitcount(key, start=None, end=None)</strong></p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取name对应的值的二进制表示中 1 的个数</span></span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># key，Redis的name</span></span><br><span class="line">    <span class="meta"># start，位起始位置</span></span><br><span class="line">    <span class="meta"># <span class="keyword">end</span>，位结束位置</span></span><br></pre></td></tr></table></figure>

<p><strong>bitop(operation, dest, *keys)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取多个值，并将值做位运算，将最后的结果保存至新的name对应的值</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># operation,AND（并） 、 OR（或） 、 NOT（非） 、 XOR（异或）</span></span><br><span class="line">    <span class="meta"># dest, 新的Redis的name</span></span><br><span class="line">    <span class="meta"># *keys,要查找的Redis的name</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 如：</span></span><br><span class="line">    bitop(<span class="string">&quot;AND&quot;</span>, &#x27;new_name&#x27;, &#x27;n1&#x27;, &#x27;n2&#x27;, &#x27;n3&#x27;)</span><br><span class="line">    <span class="meta"># 获取Redis中n1,n2,n3对应的值，然后讲所有的值做位运算（求并集），然后将结果保存 new_name 对应的值中</span></span><br></pre></td></tr></table></figure>

<p><strong>strlen(name)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 返回name对应值的字节长度（一个汉字3个字节）</span></span><br></pre></td></tr></table></figure>

<p><strong>incr(self, name, amount=1)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 自增 name对应的值，当name不存在时，则创建name＝amount，否则，则自增。</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># name,Redis的name</span></span><br><span class="line">    <span class="meta"># amount,自增数（必须是整数）</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 注：同incrby</span></span><br></pre></td></tr></table></figure>

<p><strong>incrbyfloat(self, name, amount=1.0)</strong></p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 自增 <span class="keyword">name</span>对应的值，当<span class="keyword">name</span>不存在时，则创建<span class="keyword">name</span>＝amount，否则，则自增。</span><br><span class="line"> </span><br><span class="line"># 参数：</span><br><span class="line">    # <span class="keyword">name</span>,Redis的<span class="keyword">name</span></span><br><span class="line">    # amount,自增数（浮点型）</span><br></pre></td></tr></table></figure>

<p><strong>decr(self, name, amount=1)</strong></p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># 自减 <span class="keyword">name</span>对应的值，当<span class="keyword">name</span>不存在时，则创建<span class="keyword">name</span>＝amount，否则，则自减。</span><br><span class="line"> </span><br><span class="line"># 参数：</span><br><span class="line">    # <span class="keyword">name</span>,Redis的<span class="keyword">name</span></span><br><span class="line">    # amount,自减数（整数）</span><br></pre></td></tr></table></figure>

<p><strong>append(key, value)</strong></p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 在redis name对应的值后面追加内容</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="built_in">key</span>, redis的name</span><br><span class="line">    value, 要追加的字符串</span><br></pre></td></tr></table></figure>

<h2 id="六-操作之Hash操作"><a href="#六-操作之Hash操作" class="headerlink" title="六 操作之Hash操作"></a>六 操作之Hash操作</h2><p>Hash操作，redis中Hash在内存中的存储格式如下图：</p>
<p><img src="https://gitee.com/gtdong/images/raw/master/blog/1350514-20181022195454464-123231904.png" alt="img"></p>
<p><strong>hset(name, key, value)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># name对应的hash中设置一个键值对（不存在，则创建；否则，修改）</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># name，redis的name</span></span><br><span class="line">    <span class="meta"># key，name对应的hash中的key</span></span><br><span class="line">    <span class="meta"># value，name对应的hash中的value</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 注：</span></span><br><span class="line">    <span class="meta"># hsetnx(name, key, value),当name对应的hash中不存在当前key时则创建（相当于添加）</span></span><br></pre></td></tr></table></figure>

<p><strong>hmset(name, mapping)</strong></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 在name对应的hash中批量设置键值对</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># name，redis的name</span></span><br><span class="line">    <span class="meta"># mapping，字典，如：&#123;<span class="string">&#x27;k1&#x27;</span>:<span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>: <span class="string">&#x27;v2&#x27;</span>&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 如：</span></span><br><span class="line">    <span class="meta"># r.hmset(<span class="string">&#x27;xx&#x27;</span>, &#123;<span class="string">&#x27;k1&#x27;</span>:<span class="string">&#x27;v1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>: <span class="string">&#x27;v2&#x27;</span>&#125;)</span></span><br></pre></td></tr></table></figure>

<p><strong>hget(name,key)</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">在name对应的<span class="built_in">hash</span>中获取根据key获取value</span></span><br></pre></td></tr></table></figure>

<p><strong>hmget(name, keys, *args)</strong></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 在name对应的hash中获取多个key的值</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># name，reids对应的name</span></span><br><span class="line">    <span class="meta"># keys，要获取key集合，如：[<span class="string">&#x27;k1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>, <span class="string">&#x27;k3&#x27;</span>]</span></span><br><span class="line">    <span class="meta"># *args，要获取的key，如：k1,k2,k3</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 如：</span></span><br><span class="line">    <span class="meta"># r.mget(<span class="string">&#x27;xx&#x27;</span>, [<span class="string">&#x27;k1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>])</span></span><br><span class="line">    <span class="meta"># 或</span></span><br><span class="line">    <span class="meta"># print r.hmget(<span class="string">&#x27;xx&#x27;</span>, <span class="string">&#x27;k1&#x27;</span>, <span class="string">&#x27;k2&#x27;</span>)</span></span><br></pre></td></tr></table></figure>

<p><strong>hgetall(name)</strong></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取name对应hash的所有键值</span></span><br><span class="line"><span class="built_in">print</span>(re.hgetall(<span class="string">&#x27;xxx&#x27;</span>).<span class="built_in">get</span>(b<span class="string">&#x27;name&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p><strong>hlen(name)</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取name对应的<span class="built_in">hash</span>中键值对的个数</span></span><br></pre></td></tr></table></figure>

<p><strong>hkeys(name)</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取name对应的<span class="built_in">hash</span>中所有的key的值</span></span><br></pre></td></tr></table></figure>

<p><strong>hvals(name)</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">获取name对应的<span class="built_in">hash</span>中所有的value的值</span></span><br></pre></td></tr></table></figure>

<p><strong>hexists(name, key)</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">检查name对应的<span class="built_in">hash</span>是否存在当前传入的key</span></span><br></pre></td></tr></table></figure>

<p><strong>hdel(name,*keys)</strong></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将name对应的hash中指定key的键值对删除</span></span><br><span class="line"><span class="built_in">print</span>(re.hdel(<span class="string">&#x27;xxx&#x27;</span>,<span class="string">&#x27;sex&#x27;</span>,<span class="string">&#x27;name&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p><strong>hincrby(name, key, amount=1)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 自增name对应的hash中的指定key的值，不存在则创建key=amount</span></span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># name，redis中的name</span></span><br><span class="line">    <span class="meta"># key， hash对应的key</span></span><br><span class="line">    <span class="meta"># amount，自增数（整数）</span></span><br></pre></td></tr></table></figure>

<p><strong>hincrbyfloat(name, key, amount=1.0)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 自增name对应的hash中的指定key的值，不存在则创建key=amount</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># name，redis中的name</span></span><br><span class="line">    <span class="meta"># key， hash对应的key</span></span><br><span class="line">    <span class="meta"># amount，自增数（浮点数）</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 自增name对应的hash中的指定key的值，不存在则创建key=amount</span></span><br></pre></td></tr></table></figure>

<p><strong>hscan(name, cursor=0, match=None, count=None)</strong></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 增量式迭代获取，对于数据大的数据非常有用，hscan可以实现分片的获取数据，并非一次性将数据全部获取完，从而放置内存被撑爆</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 参数：</span></span><br><span class="line">    # name，redis的name</span><br><span class="line">    # cursor，游标（基于游标分批取获取数据）</span><br><span class="line">    # match，匹配指定key，默认None 表示所有的key</span><br><span class="line">    # count，每次分片最少获取个数，默认None表示采用Redis的默认分片个数</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 如：</span></span><br><span class="line">    # 第一次：cursor1, data1 = r.hscan(<span class="string">&#x27;xx&#x27;</span>, <span class="attribute">cursor</span>=0, <span class="attribute">match</span>=None, <span class="attribute">count</span>=None)</span><br><span class="line">    # 第二次：cursor2, data1 = r.hscan(<span class="string">&#x27;xx&#x27;</span>, <span class="attribute">cursor</span>=cursor1, <span class="attribute">match</span>=None, <span class="attribute">count</span>=None)</span><br><span class="line">    # <span class="built_in">..</span>.</span><br><span class="line">    # 直到返回值cursor的值为0时，表示数据已经通过分片获取完毕</span><br></pre></td></tr></table></figure>

<p><strong>hscan_iter(name, match=None, count=None)</strong></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 利用yield封装hscan创建生成器，实现分批去redis中获取数据</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 参数：</span></span><br><span class="line">    <span class="comment"># match，匹配指定key，默认None 表示所有的key</span></span><br><span class="line">    <span class="comment"># count，每次分片最少获取个数，默认None表示采用Redis的默认分片个数</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 如：</span></span><br><span class="line">    <span class="comment"># for item in r.hscan_iter(&#x27;xx&#x27;):</span></span><br><span class="line">    <span class="comment">#     print item</span></span><br></pre></td></tr></table></figure>

<h2 id="七-操作之List操作"><a href="#七-操作之List操作" class="headerlink" title="七 操作之List操作"></a>七 操作之List操作</h2><p>List操作，redis中的List在在内存中按照一个name对应一个List来存储。如图：</p>
<p><a target="_blank" rel="noopener" href="https://img2018.cnblogs.com/blog/1350514/201810/1350514-20181022211822785-370585666.png"><img src="https://img2018.cnblogs.com/blog/1350514/201810/1350514-20181022211822785-370585666.png" alt="img"></a></p>
<p><strong>lpush(name,values)</strong></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 在name对应的list中添加元素，每个新的元素都添加到列表的最左边</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 如：</span></span><br><span class="line">    <span class="meta"># r.lpush(<span class="string">&#x27;oo&#x27;</span>, 11,22,33)</span></span><br><span class="line">    <span class="meta"># 保存顺序为: 33,22,11</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 扩展：</span></span><br><span class="line">    <span class="meta"># rpush(name, values) 表示从右向左操作</span></span><br></pre></td></tr></table></figure>

<p><strong>lpushx(name,value)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 在name对应的list中添加元素，只有name已经存在时，值添加到列表的最左边</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 更多：</span></span><br><span class="line">    <span class="meta"># rpushx(name, value) 表示从右向左操作</span></span><br></pre></td></tr></table></figure>

<p><strong>llen(name)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># name对应的list元素的个数</span></span><br></pre></td></tr></table></figure>

<p><strong>linsert(name, where, refvalue, value))</strong></p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 在name对应的列表的某一个值前或后插入一个新值</span><br><span class="line"> </span><br><span class="line"># 参数：</span><br><span class="line">    # name，redis的name</span><br><span class="line">    # <span class="keyword">where</span>，BEFORE或AFTER(小写也可以)</span><br><span class="line">    # refvalue，标杆值，即：在它前后插入数据（如果存在多个标杆值，以找到的第一个为准）</span><br><span class="line">    # value，要插入的数据</span><br></pre></td></tr></table></figure>

<p><strong>r.lset(name, index, value)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 对name对应的list中的某一个索引位置重新赋值</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># name，redis的name</span></span><br><span class="line">    <span class="meta"># index，list的索引位置</span></span><br><span class="line">    <span class="meta"># value，要设置的值</span></span><br></pre></td></tr></table></figure>

<p><strong>r.lrem(name, value, num)</strong></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在name对应的list中删除指定的值</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 参数：</span></span><br><span class="line">    # name，redis的name</span><br><span class="line">    # value，要删除的值</span><br><span class="line">    # num，  <span class="attribute">num</span>=0，删除列表中所有的指定值；</span><br><span class="line">           # <span class="attribute">num</span>=2,从前到后，删除2个；</span><br><span class="line">           # <span class="attribute">num</span>=-2,从后向前，删除2个</span><br></pre></td></tr></table></figure>

<p><strong>lpop(name)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 在name对应的列表的左侧获取第一个元素并在列表中移除，返回值则是第一个元素</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 更多：</span></span><br><span class="line">    <span class="meta"># rpop(name) 表示从右向左操作</span></span><br></pre></td></tr></table></figure>

<p><strong>lindex(name, index)</strong></p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在<span class="keyword">name</span>对应的列表中根据索引获取列表元素</span><br></pre></td></tr></table></figure>

<p><strong>lrange(name, start, end)</strong></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 在name对应的列表分片获取数据</span></span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># name，redis的name</span></span><br><span class="line">    <span class="meta"># start，索引的起始位置</span></span><br><span class="line">    <span class="meta"># end，索引结束位置  print(re.lrange(<span class="string">&#x27;aa&#x27;</span>,0,re.llen(<span class="string">&#x27;aa&#x27;</span>)))</span></span><br></pre></td></tr></table></figure>

<p><strong>ltrim(name, start, end)</strong></p>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 在name对应的列表中移除没有在start-<span class="keyword">end</span>索引之间的值</span></span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># name，redis的name</span></span><br><span class="line">    <span class="meta"># start，索引的起始位置</span></span><br><span class="line">    <span class="meta"># <span class="keyword">end</span>，索引结束位置（大于列表长度，则代表不移除任何）</span></span><br></pre></td></tr></table></figure>

<p><strong>rpoplpush(src, dst)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 从一个列表取出最右边的元素，同时将其添加至另一个列表的最左边</span></span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># src，要取数据的列表的name</span></span><br><span class="line">    <span class="meta"># dst，要添加数据的列表的name</span></span><br></pre></td></tr></table></figure>

<p><strong>blpop(keys, timeout)</strong></p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将多个列表排列，按照从左到右去pop对应列表的元素</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 参数：</span></span><br><span class="line">    <span class="comment"># keys，redis的name的集合</span></span><br><span class="line">    <span class="comment"># timeout，超时时间，当元素所有列表的元素获取完之后，阻塞等待列表内有数据的时间（秒）, 0 表示永远阻塞</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 更多：</span></span><br><span class="line">    <span class="comment"># r.brpop(keys, timeout)，从右向左获取数据</span></span><br><span class="line">爬虫实现简单分布式：多个url放到列表里，往里不停放<span class="built_in">URL</span>，程序循环取值，但是只能一台机器运行取值，可以把url放到redis中，多台机器从redis中取值，爬取数据，实现简单分布式</span><br></pre></td></tr></table></figure>

<p><strong>brpoplpush(src, dst, timeout=0)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 从一个列表的右侧移除一个元素并将其添加到另一个列表的左侧</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># src，取出并要移除元素的列表对应的name</span></span><br><span class="line">    <span class="meta"># dst，要插入元素的列表对应的name</span></span><br><span class="line">    <span class="meta"># timeout，当src对应的列表中没有数据时，阻塞等待其有数据的超时时间（秒），0 表示永远阻塞</span></span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></p>
<p><strong>自定义增量迭代</strong></p>
<figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 由于redis类库中没有提供对列表元素的增量迭代，如果想要循环name对应的列表的所有元素，那么就需要：</span></span><br><span class="line"><span class="comment">    # 1、获取name对应的所有列表</span></span><br><span class="line"><span class="comment">    # 2、循环列表</span></span><br><span class="line"><span class="comment"># 但是，如果列表非常大，那么就有可能在第一步时就将程序的内容撑爆，所有有必要自定义一个增量迭代的功能：</span></span><br><span class="line">import redis</span><br><span class="line">conn=redis.Redis(host=&#x27;<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>&#x27;,port=<span class="number">6379</span>)</span><br><span class="line"><span class="comment"># conn.lpush(&#x27;test&#x27;,*[1,2,3,4,45,5,6,7,7,8,43,5,6,768,89,9,65,4,23,54,6757,8,68])</span></span><br><span class="line"><span class="comment"># conn.flushall()</span></span><br><span class="line">def scan_list(name,count=<span class="number">2</span>):</span><br><span class="line">    index=<span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> True:</span><br><span class="line">        data_list=conn.<span class="keyword">lrange</span>(name,index,count+index<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">if</span> not data_list:</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        index+=count</span><br><span class="line">        <span class="keyword">for</span> item in data_list:</span><br><span class="line">            yield item</span><br><span class="line">print(conn.<span class="keyword">lrange</span>(&#x27;test&#x27;,<span class="number">0</span>,<span class="number">100</span>))</span><br><span class="line"><span class="keyword">for</span> item in scan_list(&#x27;test&#x27;,<span class="number">5</span>):</span><br><span class="line">    print(&#x27;---&#x27;)</span><br><span class="line">    print(item)</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></p>
<h2 id="八-操作之Set操作"><a href="#八-操作之Set操作" class="headerlink" title="八 操作之Set操作"></a>八 操作之Set操作</h2><p>Set操作，Set集合就是不允许重复的列表</p>
<p> <strong>sadd(name,values)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># name对应的集合中添加元素</span></span><br></pre></td></tr></table></figure>

<p><strong>scard(name)</strong></p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">获取<span class="keyword">name</span>对应的集合中元素个数</span><br></pre></td></tr></table></figure>

<p><strong>sdiff(keys, *args)</strong></p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在第一个<span class="keyword">name</span>对应的集合中且不在其他<span class="keyword">name</span>对应的集合的元素集合</span><br></pre></td></tr></table></figure>

<p><strong>sdiffstore(dest, keys, *args)</strong></p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 获取第一个<span class="keyword">name</span>对应的集合中且不在其他<span class="keyword">name</span>对应的集合，再将其新加入到dest对应的集合中</span><br></pre></td></tr></table></figure>

<p><strong>sinter(keys, *args)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取多一个name对应集合的并集</span></span><br></pre></td></tr></table></figure>

<p><strong>sinterstore(dest, keys, *args)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取多一个name对应集合的并集，再讲其加入到dest对应的集合中</span></span><br></pre></td></tr></table></figure>

<p><strong>sismember(name, value)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 检查value是否是name对应的集合的成员</span></span><br></pre></td></tr></table></figure>

<p><strong>smembers(name)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取name对应的集合的所有成员</span></span><br></pre></td></tr></table></figure>

<p><strong>smove(src, dst, value)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 将某个成员从一个集合中移动到另外一个集合</span></span><br></pre></td></tr></table></figure>

<p><strong>spop(name)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 从集合的右侧（尾部）移除一个成员，并将其返回</span></span><br></pre></td></tr></table></figure>

<p><strong>srandmember(name, numbers)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 从name对应的集合中随机获取 numbers 个元素</span></span><br></pre></td></tr></table></figure>

<p><strong>srem(name, values)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 在name对应的集合中删除某些值</span></span><br></pre></td></tr></table></figure>

<p><strong>srem(name, values)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 在name对应的集合中删除某些值</span></span><br></pre></td></tr></table></figure>

<p><strong>sunion(keys, *args)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取多一个name对应的集合的并集</span></span><br></pre></td></tr></table></figure>

<p><strong>sunionstore(dest,keys, *args)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取多一个name对应的集合的并集，并将结果保存到dest对应的集合中</span></span><br></pre></td></tr></table></figure>

<p><strong>sscan(name, cursor=0, match=None, count=None)</strong><br><strong>sscan_iter(name, match=None, count=None)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 同字符串的操作，用于增量迭代分批获取元素，避免内存消耗太大</span></span><br></pre></td></tr></table></figure>

<p><strong>有序集合，在集合的基础上，为每元素排序；元素的排序需要根据另外一个值来进行比较，所以，对于有序集合，每一个元素有两个值，即：值和分数，分数专门用来做排序。</strong></p>
<p> *<em>zadd(name, *args, *<em>kwargs)</em></em></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在name对应的有序集合中添加元素</span></span><br><span class="line"><span class="comment"># 如：</span></span><br><span class="line">     # zadd(<span class="string">&#x27;zz&#x27;</span>, <span class="string">&#x27;n1&#x27;</span>, 1, <span class="string">&#x27;n2&#x27;</span>, 2)</span><br><span class="line">     # 或</span><br><span class="line">     # zadd(<span class="string">&#x27;zz&#x27;</span>, <span class="attribute">n1</span>=11, <span class="attribute">n2</span>=22)</span><br></pre></td></tr></table></figure>

<p><strong>zcard(name)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取name对应的有序集合元素的数量</span></span><br></pre></td></tr></table></figure>

<p><strong>zcount(name, min, max)</strong></p>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 获取<span class="keyword">name</span>对应的有序集合中分数 在 [<span class="built_in">min</span>,<span class="built_in">max</span>] 之间的个数</span><br></pre></td></tr></table></figure>

<p><strong>zincrby(name, value, amount)</strong></p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 自增<span class="keyword">name</span>对应的有序集合的 <span class="keyword">name</span> 对应的分数</span><br></pre></td></tr></table></figure>

<p><strong>r.zrange( name, start, end, desc=False, withscores=False, score_cast_func=float)</strong></p>
<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照索引范围获取name对应的有序集合的元素</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 参数：</span></span><br><span class="line">    # name，redis的name</span><br><span class="line">    # start，有序集合索引起始位置（非分数）</span><br><span class="line">    # end，有序集合索引结束位置（非分数）</span><br><span class="line">    # desc，排序规则，默认按照分数从小到大排序</span><br><span class="line">    # withscores，是否获取元素的分数，默认只获取元素的值</span><br><span class="line">    # score_cast_func，对分数进行数据转换的函数</span><br><span class="line"> </span><br><span class="line"><span class="comment"># 更多：</span></span><br><span class="line">    # 从大到小排序</span><br><span class="line">    # zrevrange(name, start, end, <span class="attribute">withscores</span>=<span class="literal">False</span>, <span class="attribute">score_cast_func</span>=float)</span><br><span class="line"> </span><br><span class="line">    # 按照分数范围获取name对应的有序集合的元素</span><br><span class="line">    # zrangebyscore(name, min, max, <span class="attribute">start</span>=None, <span class="attribute">num</span>=None, <span class="attribute">withscores</span>=<span class="literal">False</span>, <span class="attribute">score_cast_func</span>=float)</span><br><span class="line">    # 从大到小排序</span><br><span class="line">    # zrevrangebyscore(name, max, min, <span class="attribute">start</span>=None, <span class="attribute">num</span>=None, <span class="attribute">withscores</span>=<span class="literal">False</span>, <span class="attribute">score_cast_func</span>=float)</span><br></pre></td></tr></table></figure>

<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></p>
<p><strong>zrank(name, value)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取某个值在 name对应的有序集合中的排行（从 0 开始）</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 更多：</span></span><br><span class="line">    <span class="meta"># zrevrank(name, value)，从大到小排序</span></span><br></pre></td></tr></table></figure>

<p><strong>zrangebylex(name, min, max, start=None, num=None)</strong></p>
<p><a href="javascript:void(0);"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码"></a></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 当有序集合的所有成员都具有相同的分值时，有序集合的元素会根据成员的 值 （lexicographical ordering）来进行排序，而这个命令则可以返回给定的有序集合键 key 中， 元素的值介于 min 和 max 之间的成员</span></span><br><span class="line"><span class="meta"># 对集合中的每个成员进行逐个字节的对比（byte-by-byte compare）， 并按照从低到高的顺序， 返回排序后的集合成员。 如果两个字符串有一部分内容是相同的话， 那么命令会认为较长的字符串比较短的字符串要大</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 参数：</span></span><br><span class="line">    <span class="meta"># name，redis的name</span></span><br><span class="line">    <span class="meta"># min，左区间（值）。 + 表示正无限； - 表示负无限； ( 表示开区间； [ 则表示闭区间</span></span><br><span class="line">    <span class="meta"># min，右区间（值）</span></span><br><span class="line">    <span class="meta"># start，对结果进行分片处理，索引位置</span></span><br><span class="line">    <span class="meta"># num，对结果进行分片处理，索引后面的num个元素</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 如：</span></span><br><span class="line">    <span class="meta"># ZADD myzset 0 aa 0 ba 0 ca 0 da 0 ea 0 fa 0 ga</span></span><br><span class="line">    <span class="meta"># r.zrangebylex(<span class="string">&#x27;myzset&#x27;</span>, <span class="string">&quot;-&quot;</span>, <span class="string">&quot;[ca&quot;</span>) 结果为：[<span class="string">&#x27;aa&#x27;</span>, <span class="string">&#x27;ba&#x27;</span>, <span class="string">&#x27;ca&#x27;</span>]</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 更多：</span></span><br><span class="line">    <span class="meta"># 从大到小排序</span></span><br><span class="line">    <span class="meta"># zrevrangebylex(name, max, min, start=None, num=None)</span></span><br></pre></td></tr></table></figure>


<p><strong>zrem(name, values)</strong></p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 删除name对应的有序集合中值是values的成员</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 如：zrem(<span class="string">&#x27;zz&#x27;</span>, [<span class="string">&#x27;s1&#x27;</span>, <span class="string">&#x27;s2&#x27;</span>])</span></span><br></pre></td></tr></table></figure>

<p><strong>zremrangebyrank(name, min, max)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 根据排行范围删除</span></span><br></pre></td></tr></table></figure>

<p><strong>zremrangebyscore(name, min, max)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 根据分数范围删除</span></span><br></pre></td></tr></table></figure>

<p><strong>zremrangebylex(name, min, max)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 根据值返回删除</span></span><br></pre></td></tr></table></figure>

<p><strong>zscore(name, value)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取name对应有序集合中 value 对应的分数</span></span><br></pre></td></tr></table></figure>

<p><strong>zinterstore(dest, keys, aggregate=None)</strong></p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 获取两个有序集合的交集，如果遇到相同值不同分数，则按照<span class="built_in">aggregate</span>进行操作</span><br><span class="line"># <span class="built_in">aggregate</span>的值为<span class="symbol">:</span>  <span class="built_in">SUM</span>  <span class="built_in">MIN</span>  <span class="built_in">MAX</span></span><br></pre></td></tr></table></figure>

<p><strong>zunionstore(dest, keys, aggregate=None)</strong></p>
<figure class="highlight excel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 获取两个有序集合的并集，如果遇到相同值不同分数，则按照<span class="built_in">aggregate</span>进行操作</span><br><span class="line"># <span class="built_in">aggregate</span>的值为<span class="symbol">:</span>  <span class="built_in">SUM</span>  <span class="built_in">MIN</span>  <span class="built_in">MAX</span></span><br></pre></td></tr></table></figure>

<p><strong>zscan(name, cursor=0, match=None, count=None, score_cast_func=float)</strong><br><strong>zscan_iter(name, match=None, count=None,score_cast_func=float)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 同字符串相似，相较于字符串新增score_cast_func，用来对分数进行操作</span></span><br></pre></td></tr></table></figure>

<h2 id="九-其它操作"><a href="#九-其它操作" class="headerlink" title="九 其它操作"></a>九 其它操作</h2><p><strong>delete(*names)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 根据删除redis中的任意数据类型</span></span><br></pre></td></tr></table></figure>

<p><strong>exists(name)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 检测redis的name是否存在</span></span><br></pre></td></tr></table></figure>

<p><strong>keys(pattern=’*‘)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 根据模型获取redis的name</span></span><br><span class="line"> </span><br><span class="line"><span class="meta"># 更多：</span></span><br><span class="line">    <span class="meta"># KEYS * 匹配数据库中所有 key 。</span></span><br><span class="line">    <span class="meta"># KEYS h?llo 匹配 hello ， hallo 和 hxllo 等。</span></span><br><span class="line">    <span class="meta"># KEYS h*llo 匹配 hllo 和 heeeeello 等。</span></span><br><span class="line">    <span class="meta"># KEYS h[ae]llo 匹配 hello 和 hallo ，但不匹配 hillo </span></span><br></pre></td></tr></table></figure>



<p><strong>expire(name ,time)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 为某个redis的某个name设置超时时间</span></span><br></pre></td></tr></table></figure>

<p><strong>rename(src, dst)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 对redis的name重命名为</span></span><br></pre></td></tr></table></figure>

<p><strong>move(name, db))</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 将redis的某个值移动到指定的db下</span></span><br></pre></td></tr></table></figure>

<p><strong>randomkey()</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 随机获取一个redis的name（不删除）</span></span><br></pre></td></tr></table></figure>

<p><strong>type(name)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 获取name对应值的类型</span></span><br></pre></td></tr></table></figure>

<p><strong>scan(cursor=0, match=None, count=None)</strong><br><strong>scan_iter(match=None, count=None)</strong></p>
<figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"># 同字符串操作，用于增量迭代获取key</span></span><br></pre></td></tr></table></figure>

<h2 id="十一-管道"><a href="#十一-管道" class="headerlink" title="十一 管道"></a>十一 管道</h2><p>redis-py默认在执行每次请求都会创建（连接池申请连接）和断开（归还连接池）一次连接操作，如果想要在一次请求中指定多个命令，则可以使用pipline实现一次请求指定多个命令，并且默认情况下一次pipline 是原子性操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"> </span><br><span class="line">pool = redis.ConnectionPool(host=<span class="string">&#x27;10.211.55.4&#x27;</span>, port=<span class="number">6379</span>)</span><br><span class="line"> </span><br><span class="line">r = redis.Redis(connection_pool=pool)</span><br><span class="line"> </span><br><span class="line"><span class="comment"># pipe = r.pipeline(transaction=False)</span></span><br><span class="line">pipe = r.pipeline(transaction=<span class="literal">True</span>)</span><br><span class="line">pipe.multi()</span><br><span class="line">pipe.<span class="built_in">set</span>(<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;alex&#x27;</span>)</span><br><span class="line">pipe.<span class="built_in">set</span>(<span class="string">&#x27;role&#x27;</span>, <span class="string">&#x27;sb&#x27;</span>)</span><br><span class="line"> </span><br><span class="line">pipe.execute()</span><br></pre></td></tr></table></figure>



<h2 id="十二-Django中使用redis"><a href="#十二-Django中使用redis" class="headerlink" title="十二 Django中使用redis"></a>十二 Django中使用redis</h2><p><strong>方式一：</strong></p>
<p>utils文件夹下，建立redis_pool.py</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">import redis</span><br><span class="line">POOL = redis.ConnectionPool(host=&#x27;127.0.0.1&#x27;, port=6379,password=&#x27;1234&#x27;,max_connections=1000)</span><br></pre></td></tr></table></figure>

<p>视图函数中使用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render,HttpResponse</span><br><span class="line"><span class="keyword">from</span> utils.redis_pool <span class="keyword">import</span> POOL</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    conn = redis.Redis(connection_pool=POOL)</span><br><span class="line">    conn.hset(<span class="string">&#x27;kkk&#x27;</span>,<span class="string">&#x27;age&#x27;</span>,<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&#x27;设置成功&#x27;</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">order</span>(<span class="params">request</span>):</span><br><span class="line">    conn = redis.Redis(connection_pool=POOL)</span><br><span class="line">    conn.hget(<span class="string">&#x27;kkk&#x27;</span>,<span class="string">&#x27;age&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> HttpResponse(<span class="string">&#x27;获取成功&#x27;</span>)</span><br></pre></td></tr></table></figure>



<p><strong>方式二：</strong></p>
<p>安装django-redis模块</p>
<p>pip3 install django-redis</p>
<p>setting里配置：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># redis配置</span></span><br><span class="line">CACHES = &#123;</span><br><span class="line">    <span class="string">&quot;default&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;BACKEND&quot;</span>: <span class="string">&quot;django_redis.cache.RedisCache&quot;</span>,</span><br><span class="line">        <span class="string">&quot;LOCATION&quot;</span>: <span class="string">&quot;redis://127.0.0.1:6379&quot;</span>,</span><br><span class="line">        <span class="string">&quot;OPTIONS&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;CLIENT_CLASS&quot;</span>: <span class="string">&quot;django_redis.client.DefaultClient&quot;</span>,</span><br><span class="line">            <span class="string">&quot;CONNECTION_POOL_KWARGS&quot;</span>: &#123;<span class="string">&quot;max_connections&quot;</span>: <span class="number">100</span>&#125;</span><br><span class="line">            <span class="comment"># &quot;PASSWORD&quot;: &quot;123&quot;,</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>视图函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django_redis <span class="keyword">import</span> get_redis_connection</span><br><span class="line">conn = get_redis_connection(<span class="string">&#x27;default&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(conn.hgetall(<span class="string">&#x27;xxx&#x27;</span>))</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer"><div class="post-widgets">
      <div id="needsharebutton-postbottom">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    </div>
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    赞赏
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.jpeg" alt="Michaeldong 微信">
        <span>微信</span>
      </div>
      <div>
        <img src="/images/alipay.jpeg" alt="Michaeldong 支付宝">
        <span>支付宝</span>
      </div>

  </div>
</div>

          <div class="post-tags">
              <a href="/tags/Python/" rel="tag"># Python</a>
              <a href="/tags/Redis/" rel="tag"># Redis</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2018/07/25/63.git%E7%AC%94%E8%AE%B0/" rel="prev" title="git笔记">
                  <i class="fa fa-chevron-left"></i> git笔记
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2018/07/27/65.celery%E7%AC%94%E8%AE%B0/" rel="next" title="celery笔记">
                  celery笔记 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Michaeldong</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">1.2m</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">18:05</span>
  </span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="https://cdn.jsdelivr.net/npm/hexo-generator-searchdb@1.4.0/dist/search.js" integrity="sha256-vXZMYLEqsROAXkEw93GGIvaB2ab+QW6w3+1ahD9nXXA=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>
<script class="next-config" data-name="chatra" type="application/json">{"enable":true,"async":true,"id":"9D92XKxDbxTrStQPr"}</script>
<script src="/js/third-party/chat/chatra.js"></script>
<script async src="https://call.chatra.io/chatra.js"></script>





  





  <script src="//cdn.jsdelivr.net/gh/theme-next/theme-next-needmoreshare2@1/needsharebutton.min.js"></script>
  <script>
      pbOptions = {};
        pbOptions.iconStyle = "box";
        pbOptions.boxForm = "horizontal";
        pbOptions.position = "bottomCenter";
        pbOptions.networks = "Wechat,QQZone,Weibo,Douban,Twitter,Facebook";
      new needShareButton('#needsharebutton-postbottom', pbOptions);
  </script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":200,"height":300,"vOffset":300},"mobile":{"show":true},"dialog":{"enable":true,"hitokoto":true}});</script></body>
</html>
